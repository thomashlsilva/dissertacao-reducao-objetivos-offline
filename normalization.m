clear all;close all; clc

x = 7900;
xmax = 999;
xmin = 750;

n = (x - xmin)/(xmax - xmin);

% disp(n);

% data = {'A': [0.879, 0.586, 0.066, 0.803],
%         'B': [0.673, 0.016, 0.710, 0.281],
%         'C': [0, 0.518, 1, 0],
%         'D': [1, 0.363, 0, 1],
%         'E': [0.432, 0.078, 0.343, 0.249],
%         'F': [0.692, 0.762, 0.006, 0.606],
%         'G': [0.469, 1, 0.268, 0.153],
%         'H': [0.844, 0, 0.332, 0.161],
        
% [ 0.101 -0.027  -0.129  0.129  0.001  0.084  0.009  0.028]
% [-0.027  0.083   0.020 -0.008  0.036 -0.054 -0.057  0.072]
% [-0.130  0.020   0.173 -0.177 -0.009 -0.096  0.017 -0.044]
% [ 0.129 -0.008  -0.177  0.184  0.015  0.089 -0.033  0.054]
% [ 0.001  0.036  -0.009  0.015  0.017 -0.014 -0.028  0.038]
% [ 0.084 -0.054  -0.096  0.089 -0.014  0.090  0.051 -0.002]
% [ 0.009 -0.057   0.017 -0.033 -0.028  0.051  0.106 -0.031]
% [ 0.028  0.072  -0.044  0.054  0.038 -0.002 -0.031  0.100]

S = [ 0.101 -0.027  -0.129  0.129  0.001  0.084  0.009  0.028;
-0.027  0.083   0.020 -0.008  0.036 -0.054 -0.057  0.072;
-0.130  0.020   0.173 -0.177 -0.009 -0.096  0.017 -0.044;
 0.129 -0.008  -0.177  0.184  0.015  0.089 -0.033  0.054;
 0.001  0.036  -0.009  0.015  0.017 -0.014 -0.028  0.038;
 0.084 -0.054  -0.096  0.089 -0.014  0.090  0.051 -0.002;
 0.009 -0.057   0.017 -0.033 -0.028  0.051  0.106 -0.031;
 0.028  0.072  -0.044  0.054  0.038 -0.002 -0.031  0.100];

newS = [ 0.13444364 -0.03548026 -0.17210727  0.17203212  0.00175451  0.11214116 0.01179321  0.03776955;
 -0.03548026  0.11030192  0.02685349 -0.01079169  0.04752082 -0.07181254 -0.0764131   0.09576727;
 -0.17210727  0.02685349  0.23076011 -0.23626585 -0.0116522  -0.12792101 0.02303974 -0.05847784;
  0.17203212 -0.01079169 -0.23626585  0.24532202  0.01949621  0.11817754 -0.04400306  0.07174209;
  0.00175451  0.04752082 -0.0116522   0.01949621  0.02288123 -0.01925617 -0.03672825  0.04998677;
  0.11214116 -0.07181254 -0.12792101  0.11817754 -0.01925617  0.12001638 0.06812437 -0.00227395;
  0.01179321 -0.0764131   0.02303974 -0.04400306 -0.03672825  0.06812437 0.14081318 -0.04074848;
  0.03776955  0.09576727 -0.05847784  0.07174209  0.04998677 -0.00227395 -0.04074848  0.13374139];

invS = inv(S);
newinvS = inv(newS);

A = [0.879, 0.673, 0, 1, 0.432, 0.692, 0.469, 0.844];
B = [0.586, 0.016, 0.518, 0.363, 0.078, 0.762, 1, 0];
C = [0.066, 0.710, 1, 0, 0.343, 0.006, 0.268, 0.332];
D = [0.803, 0.281, 0, 1, 0.249, 0.606, 0.153, 0.161];

sub = A - B;
TA = transpose(A);

% mean = mean(B);
% SA = ((B(1)-mean)^2+(B(2)-mean)^2+(B(3)-mean)^2+(B(4)-mean)^2+(B(5)-mean)^2+(B(6)-mean)^2+(B(7)-mean)^2+(B(8)-mean)^2)/7;

Tsub = transpose(sub);

result = sub*newinvS*Tsub;

distance = sqrt(result);

disp(distance);

% d2 = mahal(A,S);

% disp(d2);

% soma = 1.029743 + 1.177369 + 3.830750 + 1.398830 + 1.455398 + 1.042625 + 2.554871 + 1.510414;
% 
% teste1 = sqrt(soma);
% 
% vetor = [1.029743  1.177369  3.830750  1.398830  1.455395414  1.042625  2.554871  1.510414];
% 
% teste2 = norm(vetor);

